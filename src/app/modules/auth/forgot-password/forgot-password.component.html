<div class="auth-main">
    <div class="auth_div vivify fadeIn">
        <div class="auth_brand">
            <a class="navbar-brand" href="#"><img src="assets/images/icon.svg" width="50"
                    class="d-inline-block align-top mr-2" alt="">Mooli</a>
        </div>
        <div class="card forgot-pass">
            <div *ngIf="!isOtp" class="header">
                <p class="lead"><strong>Oops</strong>,<br> forgot something?</p>
            </div>
            <div *ngIf="isOtp" class="header">
                <p class="lead">Verify Your Identity</p>
                <p class="small text-muted">We've sent a 6-digit code to your email</p>
            </div>
            <div class="body">
                <form [formGroup]="recoveryForm" *ngIf="!isOtp" class="form-auth-small" action="index.html">
                    <div class="form-group c_form_group">
                        <label>Type email to recover password.</label>
                        <input formControlName="email" type="text" class="form-control" placeholder="Register email">
                        <div style="font-size: 13px;"
                            *ngIf="recoveryForm.get('email')?.touched && recoveryForm.get('email')?.errors"
                            class="text-danger">
                            <div *ngIf="recoveryForm.get('email')?.errors?.['required']">Email is required</div>
                            <div *ngIf="recoveryForm.get('email')?.errors?.['email']">Please enter a valid email</div>
                        </div>
                    </div>
                    <div class="form-group c_form_group">
                        <div class="input-group flex">
                            <input [type]="showNewPassword ? 'text' : 'password'" class="form-control"
                                placeholder="New password" formControlName="newPassword">
                            <div class="input-group-append">
                                <i (click)="togglePasswordVisibility('newPassword')" class="fa"
                                    [ngClass]="{'fa-eye': !showConfirmPassword, 'fa-eye-slash': showConfirmPassword}"></i>
                            </div>
                        </div>
                        <div *ngIf="recoveryForm.get('newPassword')?.touched && recoveryForm.get('newPassword')?.errors"
                            class="text-danger">
                            <div style="font-size: 13px;" *ngIf="recoveryForm.get('newPassword')?.errors?.['required']">
                                Password is required
                            </div>
                            <div style="font-size: 13px;"
                                *ngIf="recoveryForm.get('newPassword')?.errors?.['minlength']">Password must be at
                                least 6 characters</div>
                        </div>
                    </div>
                    <div class="form-group c_form_group">
                        <div class="input-group flex">
                            <input [type]="showConfirmPassword ? 'text' : 'password'" class="form-control"
                                placeholder="Confirm password" formControlName="confirmPassword">
                            <div class="input-group-append">
                                <i (click)="togglePasswordVisibility('confirmPassword')" class="fa"
                                    [ngClass]="{'fa-eye': !showConfirmPassword, 'fa-eye-slash': showConfirmPassword}"></i>
                            </div>
                        </div>
                        <div *ngIf="recoveryForm.get('confirmPassword')?.touched && recoveryForm.get('confirmPassword')?.errors"
                            class="text-danger">
                            <div style="font-size: 13px;" *ngIf="recoveryForm.get('confirmPassword')?.errors?.['required'] && 
                recoveryForm.get('confirmPassword')?.value === ''">
                                Please confirm your password
                            </div>
                            <div style="font-size: 13px;" *ngIf="recoveryForm.errors?.['mismatch'] && 
                recoveryForm.get('confirmPassword')?.value !== ''">
                                Passwords do not match
                            </div>
                        </div>
                    </div>
                    <button (click)="resetPass()" type="submit" class="btn btn-dark btn-lg btn-block">RESET
                        PASSWORD</button>
                    <div class="bottom">
                        <span class="helper-text">Know your password? <a [routerLink]="'/login'"
                                href="javascript:void(0)">Login</a></span>
                    </div>
                </form>
                <form *ngIf="isOtp" [formGroup]="otpForm" (ngSubmit)="onSubmit()" class="form-auth-small">
                    <div class="form-group c_form_group">
                        <label>Verification Code</label>
                        <div class="otp-input-group">
                            <input #otpInput0 formControlName="digit0" type="text" class="form-control otp-box"
                                maxlength="1" (keyup)="handleKeyUp($event, 0)" (keydown)="handleKeyDown($event, 0)"
                                (paste)="handlePaste($event)">

                            <input #otpInput1 formControlName="digit1" type="text" class="form-control otp-box"
                                maxlength="1" (keyup)="handleKeyUp($event, 1)" (keydown)="handleKeyDown($event, 1)"
                                (paste)="handlePaste($event)">

                            <input #otpInput2 formControlName="digit2" type="text" class="form-control otp-box"
                                maxlength="1" (keyup)="handleKeyUp($event, 2)" (keydown)="handleKeyDown($event, 2)"
                                (paste)="handlePaste($event)">

                            <input #otpInput3 formControlName="digit3" type="text" class="form-control otp-box"
                                maxlength="1" (keyup)="handleKeyUp($event, 3)" (keydown)="handleKeyDown($event, 3)"
                                (paste)="handlePaste($event)">
                        </div>
                    </div>

                    <button (click)="verifyOtp()" type="submit" class="btn btn-dark btn-lg btn-block">VERIFY</button>

                    <div class="bottom">
                        <span class="helper-text m-b-10" *ngIf="showCountdown">
                            <i class="fa fa-clock-o"></i>
                            <span id="countdown">{{countdownDisplay}}</span> remaining
                        </span>
                        <span *ngIf="!showCountdown">
                            Didn't receive code?
                            <a href="javascript:void(0)" (click)="resend()">Resend</a>
                        </span>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div class="animate_lines">
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
        <div class="line"></div>
    </div>
</div>